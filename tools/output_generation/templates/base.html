<!DOCTYPE html>
<html lang="en-ka" data-theme="light">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·Éë·Éê·É¶</title>

    <!-- Favicon -->

    <link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
    <link rel="alternate icon" href="assets/favicon.svg">



    <!-- Critical CSS for above-the-fold content -->
    <style>
        /* Minimal critical styles to prevent FOUC - don't override main CSS */

        /* Basic reset */
        * {
            box-sizing: border-box;
        }

        html {
            font-size: 16px;
            -webkit-text-size-adjust: 100%;
        }

        body {
            margin: 0;
            padding: 0;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
    </style>

    <!-- Load main CSS with high priority -->
    <link rel="stylesheet" href="styles/main.css" media="all">

    <script type="module" src="scripts/main.js" defer></script>

    <!-- Global function for gloss toggle (needed for static HTML) -->
    <script>
        window.toggleGlossExpansion = function (button) {
            const expanded = button.closest('.flat-gloss').querySelector('.flat-gloss-expanded');
            const icon = button.querySelector('i');

            if (expanded.style.display === 'none') {
                expanded.style.display = 'block';
                icon.className = 'fas fa-chevron-up';
            } else {
                expanded.style.display = 'none';
                icon.className = 'fas fa-chevron-down';
            }
        };
    </script>

    <!-- Preconnect to Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Font preloading handled by Google Fonts CSS -->

    <!-- Google Fonts for Georgian and English -->
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+Georgian:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">

    <!-- Font loading script to prevent flash -->
    <script>
        // Immediately apply saved font and theme to prevent flash
        (function () {
            // Apply theme immediately - check localStorage first
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme) {
                document.documentElement.setAttribute('data-theme', savedTheme);
            }
            // If no saved theme, keep the default 'light' from HTML

            // Apply font immediately
            const savedFont = localStorage.getItem('font') || 'default';
            document.documentElement.setAttribute('data-font', savedFont);

            // Font loading handled gracefully
            // Only hide content briefly to prevent flash, then show immediately
            document.documentElement.style.visibility = 'hidden';

            // Show content quickly
            setTimeout(() => {
                document.documentElement.style.visibility = 'visible';
            }, 20);
        })();
    </script>

    <!-- Early URL anchor detection to prevent content flash -->
    <script>
        (function () {
            // Check for URL parameters immediately to prevent static content flash
            const urlParams = new URLSearchParams(window.location.search);
            const verbParam = urlParams.get('verb');
            const idParam = urlParams.get('id');
            const hash = window.location.hash;

            // Determine if we have a verb to load
            let verbId = null;

            // New format: ?verb=·Éõ·Éò·É¢·Éê·Éú·Éê&id=1
            if (verbParam && idParam && !/^\d+$/.test(verbParam)) {
                verbId = idParam;
            }
            // Legacy format: ?verb=1
            else if (verbParam && /^\d+$/.test(verbParam)) {
                verbId = verbParam;
            }
            // Hash format: #1
            else if (hash && hash.startsWith('#')) {
                verbId = hash.substring(1);
            }

            if (verbId) {
                console.log('üîó Early URL anchor detection:', verbId);

                // Hide content immediately with CSS to prevent any flash
                const style = document.createElement('style');
                style.textContent = `
                    .verb-section {
                        display: none !important;
                    }
                    .welcome-content {
                        display: none !important;
                    }
                `;
                document.head.appendChild(style);

                // Set up content management when DOM is ready
                document.addEventListener('DOMContentLoaded', function () {
                    // Create minimal loading container (invisible but detectable by main app)
                    const mainContent = document.querySelector('.main-content');
                    if (mainContent) {
                        // Add loading container without clearing existing content
                        const loadingContainer = document.createElement('div');
                        loadingContainer.className = 'verb-loading-container';
                        loadingContainer.style.display = 'none';
                        mainContent.appendChild(loadingContainer);
                    }
                });
            }

            // Ensure content is visible after fonts load, even with URL anchors
            if (document.fonts && document.fonts.ready) {
                document.fonts.ready.then(() => {
                    // Only show content if it's not already visible
                    if (document.documentElement.style.visibility === 'hidden') {
                        document.documentElement.style.visibility = 'visible';
                    }
                });
            }
        })();
    </script>

    <!-- Preconnect to Font Awesome CDN -->
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <!-- Prefetch critical resources -->
    <link rel="prefetch" href="scripts/main.js">
    <link rel="prefetch" href="styles/main.css">

    <!-- Font Awesome for icons -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" as="style"
        onload="this.onload=null;this.rel='stylesheet'">
    <noscript>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    </noscript>

</head>

<body>
    <!-- Sidebar Toggle - Top Left -->
    <button id="sidebar-toggle" class="sidebar-toggle" title="Toggle Table of Contents">
        <i class="fas fa-list"></i>
    </button>

    <!-- Theme Toggle - Top Right -->
    <button id="theme-toggle" class="theme-toggle" title="Toggle Dark/Light Mode">
        <i class="fas fa-moon"></i>
    </button>
    </div>

    <!-- Font Selector - Bottom Right -->
    <button id="font-select" class="font-select" title="Choose Font (Use ‚Üê/‚Üí arrow keys to scroll)">
        <i class="fas fa-font"></i>
    </button>

    <!-- Font Selector Dropdown (Hidden) -->
    <div id="font-select-dropdown" class="font-select-dropdown">
        <div class="font-option" data-font="default">
            <span class="font-icon">üî§</span>
            <span class="font-name">Default (Noto Sans)</span>
        </div>
        <div class="font-option" data-font="k_gorga">
            <span class="font-icon">üé®</span>
            <span class="font-name">k_gorga</span>
        </div>
        <div class="font-option" data-font="k_grigol">
            <span class="font-icon">‚úçÔ∏è</span>
            <span class="font-name">k_grigol</span>
        </div>
        <div class="font-option" data-font="k_kalig">
            <span class="font-icon">üìù</span>
            <span class="font-name">k_kalig</span>
        </div>
        <div class="font-option" data-font="k_lortki">
            <span class="font-icon">üñãÔ∏è</span>
            <span class="font-name">k_lortki</span>
        </div>
        <div class="font-option" data-font="sonata">
            <span class="font-icon">üéµ</span>
            <span class="font-name">SonataNo5</span>
        </div>
        <div class="font-option" data-font="neueimpakt">
            <span class="font-icon">üí™</span>
            <span class="font-name">NeueImpakt</span>
        </div>
    </div>

    <!-- Help Button - Bottom Left (above notepad) -->
    <button id="help-toggle" class="help-toggle" title="Help & Features">
        <i class="fas fa-question-circle"></i>
    </button>

    <!-- Notepad Button - Bottom Left -->
    <button id="notepad-toggle" class="notepad-toggle" title="Open Notepad">
        <i class="fas fa-sticky-note"></i>
    </button>


    <!-- Sidebar Modal -->
    <div id="sidebar-modal" class="sidebar-modal">
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        <div class="sidebar-content">
            <div class="sidebar-header">
                <h3>Table of Contents</h3>
                <button id="sidebar-close" class="sidebar-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="sidebar-sticky-header">
                <div class="search-container">
                    <input type="text" id="search-input" class="search-input" placeholder="Search verbs..."
                        title="Search by Georgian or English name. Use ‚Üë‚Üì arrows to navigate, Enter to select">
                    <button id="search-clear" class="search-clear-button hidden" title="Clear search">
                        <i class="fas fa-times"></i>
                    </button>
                    <div class="search-icon">
                        <i class="fas fa-search"></i>
                    </div>
                </div>
            </div>
            <div class="sidebar-body">
                <div class="toc-content-container">
                    {{TOC_CONTENT}}
                </div>
            </div>
        </div>
    </div>

    <!-- Notepad Modal -->
    <div id="notepad-modal" class="notepad-modal">
        <div class="notepad-overlay" id="notepad-overlay"></div>
        <div class="notepad-content">
            <div class="notepad-header">
                <h3>Notepad</h3>
                <div class="notepad-controls">
                    <select id="font-size-select" class="font-size-select" title="Font Size">
                        <option value="12">12px</option>
                        <option value="14">14px</option>
                        <option value="16" selected>16px</option>
                        <option value="18">18px</option>
                        <option value="20">20px</option>
                        <option value="24">24px</option>
                        <option value="28">28px</option>
                        <option value="32">32px</option>
                    </select>
                    <button id="notepad-close" class="notepad-close">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div class="notepad-body">
                <textarea id="notepad-textarea" class="notepad-textarea" placeholder="Start typing here..."></textarea>
            </div>
        </div>
    </div>

    <!-- Help Modal -->
    <div id="help-modal" class="help-modal">
        <div class="help-overlay" id="help-overlay"></div>
        <div class="help-content">
            <div class="help-header">
                <h3>Help & Features</h3>
                <button id="help-close" class="help-close">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="help-body">
                <div class="help-disclaimer">
                    <p><strong>‚ö†Ô∏è Work in Progress:</strong> This website is a personal study resource and under
                        semi-active development. It contains several mistakes, inconsistencies, and incomplete features.
                        Please do not treat this as a definitive source for Georgian verb conjugations.</p>
                </div>
                <div class="help-section">
                    <h4>üéØ Core Features</h4>
                    <ul>
                        <li><strong>Interactive Verb Tables:</strong> Tables for common conjugations of 30+ Georgian
                            verbs</li>
                        <li><strong>Theme Toggle:</strong> Switch between light and dark themes</li>
                        <li><strong>Font Selection:</strong> Choose from 7 Georgian fonts with left and right arrow key
                            navigation</li>
                        <li><strong>Search Functionality:</strong> Real-time search through verbs with keyboard
                            shortcuts</li>
                        <li><strong>Notepad:</strong> Built-in notepad with local storage</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h4>‚å®Ô∏è Keyboard Shortcuts</h4>
                    <ul>
                        <li><strong>Ctrl/Cmd + K:</strong> Open search sidebar</li>
                        <li><strong>‚Üë/‚Üì:</strong> Navigate search results</li>
                        <li><strong>Enter:</strong> Select highlighted verb</li>
                        <li><strong>‚Üê/‚Üí:</strong> Switch fonts (when notepad is closed)</li>
                        <li><strong>ESC:</strong> Close active modal</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h4>üîç How to Use</h4>
                    <ul>
                        <li><strong>Browse Verbs:</strong> Use the table of contents (top-left button) to navigate
                            between verbs</li>
                        <li><strong>Search:</strong> Click the search icon or press Ctrl+K to find specific verbs</li>
                        <li><strong>Take Notes:</strong> Click the notepad button (bottom-left) to open a writing area
                        </li>
                        <li><strong>Change Appearance:</strong> Use the theme toggle and font selector to customize your
                            experience</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h4>üìö Verb Information</h4>
                    <ul>
                        <li><strong>Conjugation Tables:</strong> See verb forms across 6 common tenses</li>
                        <li><strong>Examples:</strong> View example sentences showing how verbs are used in context</li>
                        <li><strong>Case Markings:</strong> Understand subject/object argument structure with case
                            glosses</li>
                        <li><strong>Preverbs:</strong> Explore how preverbs change verb meanings</li>
                        <li><strong>English Translations:</strong> The definite article "the" is used in English
                            translations because Georgian doesn't have common definite or indefinite articles. This
                            makes the English clearer and less ambiguous.</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h4>üé® Fonts Available</h4>
                    <ul>
                        <li><strong>Default:</strong> Noto Sans Georgian (clear and readable)</li>
                        <li><strong>k_gorga:</strong> Traditional Georgian font</li>
                        <li><strong>k_grigol:</strong> Classical Georgian font</li>
                        <li><strong>k_kalig:</strong> Calligraphic Georgian font</li>
                        <li><strong>k_lortki:</strong> Handwritten Georgian font</li>
                        <li><strong>SonataNo5:</strong> Thin curved style font</li>
                        <li><strong>NeueImpakt:</strong> Bold font</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <div class="container">
        <header>
            <h1><a href="index.html" class="header-link">·Éë·Éê·É¶</a></h1>
        </header>

        <div class="main-content">
            {{VERB_SECTIONS}}
        </div>
    </div>
</body>

</html>